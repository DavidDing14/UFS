Diffie-Hellman算法，防止中间人作祟的思路：

首先A和B用RSA算法生成自己的签名密钥，并在全网公布自己的公钥，相信在这个大环境下，中间人并不能在这一层面伪装成中间人，因为网络是公开的。

之后采用传统的Diffie-Hellman算法，A创建公开值g,p和秘密值a，算出A = g^a mod p，并将g,p,A发给B；B接收到这三个值之后，创建一个秘密值b，B = g^b mod p，将B发回给A，之后就可以通过计算得到公共的会话密钥了。

当然，在刚才的过程中，A发送g,p,A给B的时候，要先用自己的私钥Kpa对其加密；而B收到的时候，先用Kua验证签名，然后在发送B的时候用Kpb签名；而A收到的时候用Kub验证签名，这样就可以在很大程度上防止中间人的破坏了。